<!doctype html> <!-- –û–±—ä—è–≤–ª—è–µ–º —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ -->
<html lang="ru"> <!-- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —è–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
<head> <!-- –ù–∞—á–∞–ª–æ —à–∞–ø–∫–∏ -->
  <meta charset="UTF-8" /> <!-- –ö–æ–¥–∏—Ä–æ–≤–∫–∞ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å -->
  <title>–ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</title> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–ª–∞–¥–∫–∏ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" /> <!-- Bootstrap -->
  <link rel="preconnect" href="https://fonts.googleapis.com" /> <!-- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /> <!-- –ö—Ä–æ—Å—Å-–¥–æ–º–µ–Ω –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤ -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" /> <!-- –®—Ä–∏—Ñ—Ç Inter -->
  <style> /* –ù–∞—á–∞–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π */
    body { background: #0f172a; color: #e2e8f0; font-family: "Inter", system-ui, -apple-system, sans-serif; } /* –§–æ–Ω –∏ —Ç–µ–∫—Å—Ç */
    .glass { background: rgba(255, 255, 255, 0.04); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 18px; backdrop-filter: blur(10px); } /* –°—Ç–µ–∫–ª—è–Ω–Ω—ã–π —Å—Ç–∏–ª—å */
    .badge-soft { background: rgba(99, 102, 241, 0.15); color: #c7d2fe; border: 1px solid rgba(99, 102, 241, 0.35); } /* –ú—è–≥–∫–∏–π –±–µ–π–¥–∂ */
    .table > :not(caption) > * > * { background-color: transparent; color: #e2e8f0; } /* –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —è—á–µ–π–∫–∏ */
    .table-striped > tbody > tr:nth-of-type(odd) > * { background: rgba(255, 255, 255, 0.03); } /* –ü–æ–ª–æ—Å–∞—Ç–æ—Å—Ç—å */
    .shadow-soft { box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25); } /* –ú—è–≥–∫–∞—è —Ç–µ–Ω—å */
    .service-pill { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 12px; font-size: 12px; } /* –ü–∏–ª—é–ª—è —Å—Ç–∞—Ç—É—Å–∞ */
    .service-pill.info { background: rgba(56, 189, 248, 0.2); color: #bae6fd; border: 1px solid rgba(56, 189, 248, 0.5); } /* –¶–≤–µ—Ç –∏–Ω—Ñ–æ */
    .service-pill.warning { background: rgba(234, 179, 8, 0.2); color: #fef08a; border: 1px solid rgba(234, 179, 8, 0.5); } /* –¶–≤–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è */
    .service-pill.error { background: rgba(248, 113, 113, 0.2); color: #fecdd3; border: 1px solid rgba(248, 113, 113, 0.5); } /* –¶–≤–µ—Ç –æ—à–∏–±–∫–∏ */
    .service-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; } /* –¢–æ—á–∫–∞ –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ */
    .service-dot.info { background: #38bdf8; } /* –¶–≤–µ—Ç —Ç–æ—á–∫–∏ –∏–Ω—Ñ–æ */
    .service-dot.warning { background: #fbbf24; } /* –¶–≤–µ—Ç —Ç–æ—á–∫–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è */
    .service-dot.error { background: #f87171; } /* –¶–≤–µ—Ç —Ç–æ—á–∫–∏ –æ—à–∏–±–∫–∏ */
    .avatar-inline { width: 1.6em; height: 1.6em; border-radius: 999px; object-fit: cover; flex-shrink: 0; } /* –ö–ª–∞—Å—Å –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –∞–≤–∞—Ç–∞—Ä–∫–∏ */
    .attachment-pill { display: inline-flex; gap: 6px; align-items: center; padding: 4px 10px; border-radius: 12px; border: 1px solid rgba(148, 163, 184, 0.35); background: rgba(255, 255, 255, 0.05); color: #e2e8f0; font-size: 12px; text-decoration: none; } /* –ü–∏–ª—é–ª—è –≤–ª–æ–∂–µ–Ω–∏—è */
    .attachment-pill:hover { text-decoration: none; background: rgba(255, 255, 255, 0.08); } /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–∏—è */
    .attachment-photo { border-color: rgba(59, 130, 246, 0.5); color: #bfdbfe; } /* –¶–≤–µ—Ç —Ñ–æ—Ç–æ */
    .attachment-video { border-color: rgba(244, 114, 182, 0.5); color: #fbcfe8; } /* –¶–≤–µ—Ç –≤–∏–¥–µ–æ */
    .attachment-doc { border-color: rgba(74, 222, 128, 0.5); color: #bbf7d0; } /* –¶–≤–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ */
    .attachment-audio { border-color: rgba(56, 189, 248, 0.5); color: #bae6fd; } /* –¶–≤–µ—Ç –∞—É–¥–∏–æ */
    .attachment-sticker { border-color: rgba(248, 180, 0, 0.6); color: #fef08a; } /* –¶–≤–µ—Ç —Å—Ç–∏–∫–µ—Ä–æ–≤ */
    .attachment-wall { border-color: rgba(236, 72, 153, 0.6); color: #fbcfe8; } /* –¶–≤–µ—Ç –ø–æ—Å—Ç–æ–≤ */
    .attachment-link { border-color: rgba(14, 165, 233, 0.5); color: #bae6fd; } /* –¶–≤–µ—Ç —Å—Å—ã–ª–æ–∫ */
    .attachment-generic { border-color: rgba(148, 163, 184, 0.5); color: #e2e8f0; } /* –¶–≤–µ—Ç –ø—Ä–æ—á–∏—Ö –≤–ª–æ–∂–µ–Ω–∏–π */
    .attachment-group { display: flex; flex-wrap: wrap; gap: 6px; } /* –ì—Ä—É–ø–ø–∞ –≤–ª–æ–∂–µ–Ω–∏–π */
    .copy-block { display: flex; flex-direction: column; gap: 4px; padding: 6px 10px; border-radius: 12px; border: 1px dashed rgba(148, 163, 184, 0.35); background: rgba(255, 255, 255, 0.02); } /* –ë–ª–æ–∫ —Ä–µ–ø–æ—Å—Ç–∞ */
    .copy-header { display: flex; align-items: center; gap: 6px; font-size: 12px; color: #cbd5e1; } /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–ø–æ—Å—Ç–∞ */
    .copy-attachments { display: flex; flex-wrap: wrap; gap: 6px; } /* –í–ª–æ–∂–µ–Ω–∏—è —Ä–µ–ø–æ—Å—Ç–∞ */
    .content-cell { display: flex; flex-direction: column; gap: 6px; } /* –Ø—á–µ–π–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
    .gallery-backdrop { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.75); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 16px; } /* –§–æ–Ω –º–æ–¥–∞–ª–∫–∏ */
    .gallery-body { background: #0b1220; border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 16px; max-width: 900px; width: 100%; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35); display: flex; flex-direction: column; gap: 12px; padding: 16px; } /* –ö–æ—Ä–ø—É—Å –º–æ–¥–∞–ª–∫–∏ */
    .gallery-media { position: relative; min-height: 320px; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.03); border-radius: 12px; overflow: hidden; } /* –ë–ª–æ–∫ –º–µ–¥–∏–∞ */
    .gallery-media img, .gallery-media video { max-height: 540px; width: 100%; object-fit: contain; border-radius: 12px; background: #0b1220; } /* –ú–µ–¥–∏–∞ –≤ –º–æ–¥–∞–ª–∫–µ */
    .gallery-actions { display: flex; align-items: center; justify-content: space-between; gap: 12px; } /* –ü–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫ */
    .gallery-meta { display: flex; flex-direction: column; gap: 4px; font-size: 14px; color: #cbd5e1; } /* –¢–µ–∫—Å—Ç –æ–ø–∏—Å–∞–Ω–∏—è */
    .gallery-nav-btn { min-width: 42px; } /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
  </style> <!-- –ö–æ–Ω–µ—Ü —Å—Ç–∏–ª–µ–π -->
</head> <!-- –ö–æ–Ω–µ—Ü —à–∞–ø–∫–∏ -->
<body class="pb-5"> <!-- –¢–µ–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <div class="container py-4"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3 mb-4"> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
      <div> <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å -->
        <div class="d-inline-flex align-items-center gap-2 mb-2"> <!-- –ë–µ–π–¥–∂ -->
          <span class="badge-soft badge rounded-pill"> <!-- –û–±–µ—Ä—Ç–∫–∞ –±–µ–π–¥–∂–∞ -->
            –ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏ <!-- –ü–æ–¥–ø–∏—Å—å -->
          </span> <!-- –ö–æ–Ω–µ—Ü –±–µ–π–¥–∂–∞ -->
        </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ –±–µ–π–¥–∂–∞ -->
        <h1 class="fw-bold mb-1">–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h1> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <p class="text-secondary mb-0">–î–æ 1000 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —á–∞—Ç–∞–º.</p> <!-- –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ -->
      </div> <!-- –ö–æ–Ω–µ—Ü –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ -->
      <div class="d-flex flex-wrap gap-2"> <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ -->
        <a href="/" class="btn btn-outline-light">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –¥–∞—à–±–æ—Ä–¥—É</a> <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
        <button id="refresh-btn" class="btn btn-info text-dark">–û–±–Ω–æ–≤–∏—Ç—å</button> <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
        <button id="clear-btn" class="btn btn-outline-light">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button> <!-- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π -->
      </div> <!-- –ö–æ–Ω–µ—Ü –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ -->
    </div> <!-- –ö–æ–Ω–µ—Ü –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->

    <ul class="nav nav-pills mb-4 gap-2 flex-wrap"> <!-- –ü–∞–Ω–µ–ª—å –≤–∫–ª–∞–¥–æ–∫ -->
      <li class="nav-item"> <!-- –ü—É–Ω–∫—Ç –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <button id="messages-tab-btn" class="nav-link active text-light bg-primary" type="button">–õ–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</button> <!-- –ö–Ω–æ–ø–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π -->
      </li> <!-- –ö–æ–Ω–µ—Ü –ø—É–Ω–∫—Ç–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π -->
      <li class="nav-item"> <!-- –ü—É–Ω–∫—Ç –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
        <button id="service-tab-btn" class="nav-link text-light bg-dark border border-secondary" type="button">–°–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏</button> <!-- –ö–Ω–æ–ø–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
      </li> <!-- –ö–æ–Ω–µ—Ü –ø—É–Ω–∫—Ç–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
    </ul> <!-- –ö–æ–Ω–µ—Ü –ø–∞–Ω–µ–ª–∏ –≤–∫–ª–∞–¥–æ–∫ -->

    <div id="messages-section" class="d-block"> <!-- –°–µ–∫—Ü–∏—è –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π -->
      <div class="glass shadow-soft p-4 mb-4"> <!-- –ë–ª–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
        <form id="filters-form" class="row g-3 align-items-end"> <!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
          <div class="col-12 col-md-5"> <!-- –ö–æ–ª–æ–Ω–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —á–∞—Ç–æ–≤ -->
            <label class="form-label text-secondary small" for="peer-filter">–§–∏–ª—å—Ç—Ä –ø–æ peer_id</label> <!-- –ü–æ–¥–ø–∏—Å—å -->
            <select id="peer-filter" name="peer_id" class="form-select bg-dark text-light border-secondary"> <!-- –°–µ–ª–µ–∫—Ç–æ—Ä -->
              <option value="">–í—Å–µ —á–∞—Ç—ã</option> <!-- –û–ø—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
            </select> <!-- –ö–æ–Ω–µ—Ü —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ -->
          <div class="col-12 col-md-3"> <!-- –ö–æ–ª–æ–Ω–∫–∞ –ª–∏–º–∏—Ç–∞ -->
            <label class="form-label text-secondary small" for="limit-input">–õ–∏–º–∏—Ç –∑–∞–ø–∏—Å–µ–π (–¥–æ 1000)</label> <!-- –ü–æ–¥–ø–∏—Å—å -->
            <input type="number" id="limit-input" name="limit" class="form-control bg-dark text-light border-secondary" min="1" max="1000" /> <!-- –ü–æ–ª–µ –ª–∏–º–∏—Ç–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ –ª–∏–º–∏—Ç–∞ -->
          <div class="col-12 col-md-4 d-flex gap-2"> <!-- –ö–æ–ª–æ–Ω–∫–∞ –∫–Ω–æ–ø–æ–∫ -->
            <button type="submit" class="btn btn-primary flex-grow-1">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button> <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
            <a href="/logs/full" class="btn btn-outline-light">–°–±—Ä–æ—Å–∏—Ç—å</a> <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ –∫–Ω–æ–ø–æ–∫ -->
        </form> <!-- –ö–æ–Ω–µ—Ü —Ñ–æ—Ä–º—ã -->
      </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->

      <div class="glass shadow-soft p-4"> <!-- –ë–ª–æ–∫ —Ç–∞–±–ª–∏—Ü—ã -->
        <div class="d-flex justify-content-between align-items-center mb-3"> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã -->
          <div> <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å -->
            <div class="card-title mb-1">–õ–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</div> <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
            <div class="text-secondary small">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–∞–∑—ã —Å –∏–º–µ–Ω–∞–º–∏, —á–∞—Ç–∞–º–∏ –∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏.</div> <!-- –ü–æ–¥–ø–∏—Å—å -->
          </div> <!-- –ö–æ–Ω–µ—Ü –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ -->
          <div class="d-flex align-items-center gap-2"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ–π–¥–∂–µ–π -->
            <span class="badge-soft badge rounded-pill" id="timezone-hint" title="">–õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è</span> <!-- –ë–µ–π–¥–∂ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –æ —Ç–∞–π–º–∑–æ–Ω–µ -->
            <span class="badge bg-secondary">READ ONLY</span> <!-- –ë–µ–π–¥–∂ —Ä–µ–∂–∏–º–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±–µ–π–¥–∂–µ–π -->
        </div> <!-- –ö–æ–Ω–µ—Ü –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã -->
        <div class="table-responsive"> <!-- –û–±–µ—Ä—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã -->
          <table class="table table-striped align-middle mb-0"> <!-- –¢–∞–±–ª–∏—Ü–∞ -->
            <thead class="text-secondary"> <!-- –®–∞–ø–∫–∞ -->
              <tr> <!-- –°—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
                <th>–í—Ä–µ–º—è</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ -->
                <th>–ß–∞—Ç</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ —á–∞—Ç–∞ -->
                <th>–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –∞–≤—Ç–æ—Ä–∞ -->
                <th>–ë–æ—Ç?</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –±–æ—Ç–∞ -->
                <th>–û—Ç–≤–µ—Ç</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞ -->
                <th>–í–ª–æ–∂–µ–Ω–∏—è</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π -->
                <th>–¢–µ–∫—Å—Ç</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ —Ç–µ–∫—Å—Ç–∞ -->
                <th>ID VK</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ ID —Å–æ–æ–±—â–µ–Ω–∏—è –≤–æ VK -->
                <th>–ó–∞–ø–∏—Å—å</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ ID –≤ –±–∞–∑–µ -->
                <th>–î–µ–π—Å—Ç–≤–∏—è</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π -->
              </tr> <!-- –ö–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
            </thead> <!-- –ö–æ–Ω–µ—Ü —à–∞–ø–∫–∏ -->
            <tbody id="logs-body"> <!-- –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã -->
              <tr> <!-- –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä -->
                <td colspan="10" class="text-secondary">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td> <!-- –¢–µ–∫—Å—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ -->
              </tr> <!-- –ö–æ–Ω–µ—Ü –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ -->
            </tbody> <!-- –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ —Ç–∞–±–ª–∏—Ü—ã -->
          </table> <!-- –ö–æ–Ω–µ—Ü —Ç–∞–±–ª–∏—Ü—ã -->
        </div> <!-- –ö–æ–Ω–µ—Ü –æ–±–µ—Ä—Ç–∫–∏ —Ç–∞–±–ª–∏—Ü—ã -->
      </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã -->
    </div> <!-- –ö–æ–Ω–µ—Ü —Å–µ–∫—Ü–∏–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π -->

    <div id="service-section" class="d-none"> <!-- –°–µ–∫—Ü–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
      <div class="glass shadow-soft p-4 mb-4"> <!-- –ë–ª–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
        <form id="service-filters" class="row g-3 align-items-end"> <!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
          <div class="col-12 col-md-4"> <!-- –ö–æ–ª–æ–Ω–∫–∞ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏—è -->
            <label class="form-label text-secondary small" for="service-type">–¢–∏–ø –æ–ø–æ–≤–µ—â–µ–Ω–∏—è</label> <!-- –ü–æ–¥–ø–∏—Å—å -->
            <select id="service-type" class="form-select bg-dark text-light border-secondary"> <!-- –°–µ–ª–µ–∫—Ç–æ—Ä —Ç–∏–ø–∞ -->
              <option value="">–í—Å–µ</option> <!-- –û–ø—Ü–∏—è –≤—Å–µ -->
              <option value="important">–í–∞–∂–Ω—ã–µ (warning+error)</option> <!-- –û–ø—Ü–∏—è –≤–∞–∂–Ω—ã—Ö -->
              <option value="error">–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏</option> <!-- –û–ø—Ü–∏—è –æ—à–∏–±–æ–∫ -->
              <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</option> <!-- –û–ø—Ü–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π -->
              <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ</option> <!-- –û–ø—Ü–∏—è –∏–Ω—Ñ–æ -->
            </select> <!-- –ö–æ–Ω–µ—Ü —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ -->
          <div class="col-12 col-md-3"> <!-- –ö–æ–ª–æ–Ω–∫–∞ –ª–∏–º–∏—Ç–∞ -->
            <label class="form-label text-secondary small" for="service-limit">–õ–∏–º–∏—Ç —Å—Ç—Ä–æ–∫</label> <!-- –ü–æ–¥–ø–∏—Å—å -->
            <input type="number" id="service-limit" class="form-control bg-dark text-light border-secondary" min="1" max="200" value="50" /> <!-- –ü–æ–ª–µ –ª–∏–º–∏—Ç–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ –ª–∏–º–∏—Ç–∞ -->
          <div class="col-12 col-md-5"> <!-- –ö–æ–ª–æ–Ω–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ -->
            <div class="d-flex align-items-center gap-2"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–Ω–æ–ø–æ–∫ -->
              <button id="service-prev" class="btn btn-outline-light flex-grow-1" type="button">–ù–∞–∑–∞–¥</button> <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
              <button id="service-next" class="btn btn-outline-light flex-grow-1" type="button">–í–ø–µ—Ä–µ–¥</button> <!-- –ö–Ω–æ–ø–∫–∞ –≤–ø–µ—Ä–µ–¥ -->
              <span id="service-page" class="text-secondary small">‚Äî</span> <!-- –ü–æ–¥–ø–∏—Å—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
            </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–ª–æ–Ω–∫–∏ -->
        </form> <!-- –ö–æ–Ω–µ—Ü —Ñ–æ—Ä–º—ã —Ñ–∏–ª—å—Ç—Ä–∞ -->
      </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->

      <div id="service-alerts" class="glass shadow-soft p-4"> <!-- –ë–ª–æ–∫ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π -->
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-3"> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –±–ª–æ–∫–∞ -->
          <div> <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∞ -->
            <div class="card-title mb-1">–°–µ—Ä–≤–∏—Å–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è</div> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç–∞ -->
            <div class="text-secondary small">–û—à–∏–±–∫–∏, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Ä–∞–±–æ—Ç–µ —Å–µ—Ä–≤–∏—Å–∞.</div> <!-- –ü–æ–¥–ø–∏—Å—å -->
          </div> <!-- –ö–æ–Ω–µ—Ü –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ -->
          <div class="d-flex align-items-center flex-wrap gap-2"> <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ -->
            <span class="badge-soft badge rounded-pill" id="service-timezone-hint" title="">–õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è</span> <!-- –ë–µ–π–¥–∂ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–∞–π–º–∑–æ–Ω—ã -->
            <span class="badge bg-secondary">READ ONLY</span> <!-- –ë–µ–π–¥–∂ —Ä–µ–∂–∏–º–∞ -->
            <div class="d-flex flex-wrap gap-2"> <!-- –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ -->
              <button id="service-refresh" class="btn btn-info text-dark">–û–±–Ω–æ–≤–∏—Ç—å</button> <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
              <button id="service-clear" class="btn btn-outline-light">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button> <!-- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ -->
            </div> <!-- –ö–æ–Ω–µ—Ü –≥—Ä—É–ø–ø—ã –∫–Ω–æ–ø–æ–∫ -->
          </div> <!-- –ö–æ–Ω–µ—Ü –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ -->
        </div> <!-- –ö–æ–Ω–µ—Ü –∑–∞–≥–æ–ª–æ–≤–∫–∞ –±–ª–æ–∫–∞ -->
        <div class="table-responsive"> <!-- –û–±–µ—Ä—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
          <table class="table table-striped align-middle mb-0"> <!-- –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
            <thead class="text-secondary"> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã -->
              <tr> <!-- –°—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ -->
                <th>–í—Ä–µ–º—è</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ -->
                <th>–¢–∏–ø</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ —Ç–∏–ø–∞ -->
                <th>–ö–æ–¥</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –∫–æ–¥–∞ -->
                <th>–ü–æ—è—Å–Ω–µ–Ω–∏–µ</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ –ø–æ—è—Å–Ω–µ–Ω–∏—è -->
                <th>–°–æ–æ–±—â–µ–Ω–∏–µ</th> <!-- –ö–æ–ª–æ–Ω–∫–∞ —Ç–µ–∫—Å—Ç–∞ -->
              </tr> <!-- –ö–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏ -->
            </thead> <!-- –ö–æ–Ω–µ—Ü —à–∞–ø–∫–∏ -->
            <tbody id="service-logs-body"> <!-- –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
              <tr> <!-- –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä -->
                <td colspan="5" class="text-secondary">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td> <!-- –¢–µ–∫—Å—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ -->
              </tr> <!-- –ö–æ–Ω–µ—Ü –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ -->
            </tbody> <!-- –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ -->
          </table> <!-- –ö–æ–Ω–µ—Ü —Ç–∞–±–ª–∏—Ü—ã -->
        </div> <!-- –ö–æ–Ω–µ—Ü –æ–±–µ—Ä—Ç–∫–∏ -->
      </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π -->
    </div> <!-- –ö–æ–Ω–µ—Ü —Å–µ–∫—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ -->
  </div> <!-- –ö–æ–Ω–µ—Ü –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ -->

  <div id="gallery-modal" class="gallery-backdrop"> <!-- –§–æ–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≥–∞–ª–µ—Ä–µ–∏ -->
    <div class="gallery-body"> <!-- –¢–µ–ª–æ –º–æ–¥–∞–ª–∫–∏ -->
      <div class="d-flex justify-content-between align-items-center"> <!-- –®–∞–ø–∫–∞ –º–æ–¥–∞–ª–∫–∏ -->
        <div class="fw-semibold">–ü—Ä–æ—Å–º–æ—Ç—Ä –≤–ª–æ–∂–µ–Ω–∏–π</div> <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª–∫–∏ -->
        <button type="button" class="btn btn-outline-light btn-sm" id="gallery-close">–ó–∞–∫—Ä—ã—Ç—å</button> <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
      </div> <!-- –ö–æ–Ω–µ—Ü —à–∞–ø–∫–∏ -->
      <div class="gallery-media" id="gallery-media"> <!-- –ë–ª–æ–∫ –º–µ–¥–∏–∞ -->
        <div class="text-secondary">–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–ª–æ–∂–µ–Ω–∏—è</div> <!-- –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä -->
      </div> <!-- –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ –º–µ–¥–∏–∞ -->
      <div class="gallery-actions"> <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <button type="button" class="btn btn-outline-light gallery-nav-btn" id="gallery-prev">‚Üê</button> <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
        <div class="gallery-meta"> <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
          <div id="gallery-caption" class="text-light">‚Äî</div> <!-- –ü–æ–¥–ø–∏—Å—å -->
          <div id="gallery-origin" class="text-secondary">–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω</div> <!-- –ò—Å—Ç–æ—á–Ω–∏–∫ -->
          <div id="gallery-links" class="small">‚Äî</div> <!-- –°—Å—ã–ª–∫–∏ -->
        </div> <!-- –ö–æ–Ω–µ—Ü –æ–ø–∏—Å–∞–Ω–∏—è -->
        <button type="button" class="btn btn-outline-light gallery-nav-btn" id="gallery-next">‚Üí</button> <!-- –ö–Ω–æ–ø–∫–∞ –≤–ø–µ—Ä–µ–¥ -->
      </div> <!-- –ö–æ–Ω–µ—Ü –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    </div> <!-- –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ –º–æ–¥–∞–ª–∫–∏ -->
  </div> <!-- –ö–æ–Ω–µ—Ü —Ñ–æ–Ω–∞ –º–æ–¥–∞–ª–∫–∏ -->

  <script> // –ù–∞—á–∞–ª–æ —Å–∫—Ä–∏–ø—Ç–∞
    const initialLogs = {{ initial_logs|tojson }}; // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –ª–æ–≥–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞
    const initialPeers = {{ initial_peers|tojson }}; // –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
    const initialPeerId = {{ initial_peer_id|tojson }}; // –°—Ç–∞—Ä—Ç–æ–≤—ã–π peer_id
    const initialLimit = {{ initial_limit|tojson }}; // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –ª–∏–º–∏—Ç
    const initialServiceLogs = {{ initial_service_logs|tojson }}; // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏

    const logsBody = document.getElementById('logs-body'); // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã –ª–æ–≥–æ–≤
    const peerFilter = document.getElementById('peer-filter'); // –°–µ–ª–µ–∫—Ç–æ—Ä —á–∞—Ç–æ–≤
    const limitInput = document.getElementById('limit-input'); // –ü–æ–ª–µ –ª–∏–º–∏—Ç–∞
    const refreshBtn = document.getElementById('refresh-btn'); // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    const clearBtn = document.getElementById('clear-btn'); // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
    const filtersForm = document.getElementById('filters-form'); // –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    const serviceBody = document.getElementById('service-logs-body'); // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    const serviceTypeSelect = document.getElementById('service-type'); // –°–µ–ª–µ–∫—Ç–æ—Ä —Ç–∏–ø–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    const serviceLimitInput = document.getElementById('service-limit'); // –ü–æ–ª–µ –ª–∏–º–∏—Ç–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    const servicePrevBtn = document.getElementById('service-prev'); // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
    const serviceNextBtn = document.getElementById('service-next'); // –ö–Ω–æ–ø–∫–∞ –≤–ø–µ—Ä–µ–¥
    const servicePageLabel = document.getElementById('service-page'); // –¢–µ–∫—Å—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    const serviceRefreshBtn = document.getElementById('service-refresh'); // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    const serviceClearBtn = document.getElementById('service-clear'); // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    const messagesSection = document.getElementById('messages-section'); // –°–µ–∫—Ü–∏—è –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
    const serviceSection = document.getElementById('service-section'); // –°–µ–∫—Ü–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    const messagesTabBtn = document.getElementById('messages-tab-btn'); // –ö–Ω–æ–ø–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    const serviceTabBtn = document.getElementById('service-tab-btn'); // –ö–Ω–æ–ø–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    const galleryModal = document.getElementById('gallery-modal'); // –§–æ–Ω –º–æ–¥–∞–ª–∫–∏ –≥–∞–ª–µ—Ä–µ–∏
    const galleryMedia = document.getElementById('gallery-media'); // –ë–ª–æ–∫ –º–µ–¥–∏–∞ –≤ –º–æ–¥–∞–ª–∫–µ
    const galleryCaption = document.getElementById('gallery-caption'); // –ü–æ–¥–ø–∏—Å—å —Ñ–∞–π–ª–∞
    const galleryOrigin = document.getElementById('gallery-origin'); // –ò—Å—Ç–æ—á–Ω–∏–∫ —Ñ–∞–π–ª–∞
    const galleryLinks = document.getElementById('gallery-links'); // –ë–ª–æ–∫ —Å—Å—ã–ª–æ–∫
    const galleryClose = document.getElementById('gallery-close'); // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –≥–∞–ª–µ—Ä–µ–∏
    const galleryPrev = document.getElementById('gallery-prev'); // –ö–Ω–æ–ø–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    const galleryNext = document.getElementById('gallery-next'); // –ö–Ω–æ–ø–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    const galleryStore = {}; // –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
    let currentGalleryKey = null; // –¢–µ–∫—É—â–∏–π –∫–ª—é—á –∞–∫—Ç–∏–≤–Ω–æ–π –≥–∞–ª–µ—Ä–µ–∏
    let currentGalleryIndex = 0; // –¢–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ
    let galleryCounter = 0; // –°—á–µ—Ç—á–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
    let serviceOffset = 0; // –¢–µ–∫—É—â–µ–µ —Å–º–µ—â–µ–Ω–∏–µ
    let serviceTotal = 0; // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

    const timezoneInfo = Intl.DateTimeFormat().resolvedOptions(); // –ß–∏—Ç–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç–∞–π–º–∑–æ–Ω—ã
    const timezoneOffsetMinutes = new Date().getTimezoneOffset(); // –ü–æ–ª—É—á–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ –≤ –º–∏–Ω—É—Ç–∞—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ UTC
    const timezoneOffsetSign = timezoneOffsetMinutes <= 0 ? '+' : '-'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–Ω–∞–∫ —Å–º–µ—â–µ–Ω–∏—è
    const timezoneOffsetHours = String(Math.floor(Math.abs(timezoneOffsetMinutes) / 60)).padStart(2, '0'); // –í—ã—á–∏—Å–ª—è–µ–º —á–∞—Å—ã —Å–º–µ—â–µ–Ω–∏—è
    const timezoneOffsetRestMinutes = String(Math.abs(timezoneOffsetMinutes) % 60).padStart(2, '0'); // –í—ã—á–∏—Å–ª—è–µ–º –º–∏–Ω—É—Ç—ã —Å–º–µ—â–µ–Ω–∏—è
    const timezoneLabel = `UTC${timezoneOffsetSign}${timezoneOffsetHours}:${timezoneOffsetRestMinutes} (${timezoneInfo.timeZone || '–ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è'})`; // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ–¥—Å–∫–∞–∑–∫–∏
    const timeFormatter = new Intl.DateTimeFormat(undefined, { hour: '2-digit', minute: '2-digit', second: '2-digit', timeZone: timezoneInfo.timeZone, timeZoneName: 'short' }); // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

    document.getElementById('timezone-hint').title = `–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤—Ä–µ–º—è ${timezoneLabel}`; // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –±–µ–π–¥–∂–∞ —Ç–∞–π–º–∑–æ–Ω—ã –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
    document.getElementById('service-timezone-hint').title = `–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤—Ä–µ–º—è ${timezoneLabel}`; // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –±–µ–π–¥–∂–∞ —Ç–∞–π–º–∑–æ–Ω—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤

    function formatDateTime(value) { // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
      const parsed = value ? new Date(value) : null; // –ü–∞—Ä—Å–∏–º —Å—Ç—Ä–æ–∫—É –¥–∞—Ç—ã
      return parsed && !Number.isNaN(parsed.valueOf()) ? timeFormatter.format(parsed) : '‚Äî'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Ç–∏—Ä–µ
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

    function buildAvatarLabel(label, avatarUrl) { // –§—É–Ω–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ —Å –∞–≤–∞—Ç–∞—Ä–∫–æ–π
      const safeLabel = label || '‚Äî'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ—Ç
      if (avatarUrl) { // –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä
        return `<span class="d-inline-flex align-items-center gap-2"><img src="${avatarUrl}" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar-inline" loading="lazy" /> <span>${safeLabel}</span></span>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–¥–ø–∏—Å—å —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞
      return safeLabel; // –ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏

    function buildReplyPreview(reply, peerId) { // –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∫–∏ —è—á–µ–π–∫–∏ –æ—Ç–≤–µ—Ç–∞
      if (!reply || (!reply.id && !reply.text && !reply.from_id)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        return '<span class="text-secondary">‚Äî</span>'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–≤–µ—Ç–∞
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –æ—Ç–≤–µ—Ç–∞
      const replyId = reply.id ?? '‚Äî'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º ID –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      const replyText = reply.text ? reply.text.slice(0, 120) : '–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞'; // –ì–æ—Ç–æ–≤–∏–º –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞
      const replyAuthorLabel = reply.from_name ? `${reply.from_name} (ID: ${reply.from_id ?? '‚Äî'})` : reply.from_id ? `ID: ${reply.from_id}` : '–ê–≤—Ç–æ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'; // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å—å –∞–≤—Ç–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞
      const replyAuthorCell = buildAvatarLabel(replyAuthorLabel, reply.from_avatar); // –ì–æ—Ç–æ–≤–∏–º –ø–æ–¥–ø–∏—Å—å –∞–≤—Ç–æ—Ä–∞ —Å –∞–≤–∞—Ç–∞—Ä–∫–æ–π
      const replyLink = reply.id && peerId ? `<a href="https://vk.com/im?sel=${peerId}&msgid=${reply.id}" target="_blank" rel="noopener noreferrer">#${reply.id}</a>` : `#${replyId}`; // –°–æ–±–∏—Ä–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      const replyAttachmentsCount = Array.isArray(reply.attachments) ? reply.attachments.length : 0; // –°—á–∏—Ç–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      const replyAttachmentsLabel = replyAttachmentsCount ? `${replyAttachmentsCount} –≤–ª–æ–∂.` : '–ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π'; // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å—å –≤–ª–æ–∂–µ–Ω–∏–π
      return `<div class="d-flex flex-column gap-1"><div class="d-flex align-items-center gap-2">${replyLink}<span class="text-secondary small">${replyAttachmentsLabel}</span></div><div class="text-secondary small">${replyText}</div><div class="text-secondary small">${replyAuthorCell}</div></div>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º HTML —è—á–µ–π–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞

    const attachmentTypeLabels = { photo: '–§–æ—Ç–æ', video: '–í–∏–¥–µ–æ', doc: '–î–æ–∫—É–º–µ–Ω—Ç', audio_message: '–ì–æ–ª–æ—Å', audio: '–ê—É–¥–∏–æ', link: '–°—Å—ã–ª–∫–∞', sticker: '–°—Ç–∏–∫–µ—Ä', wall: '–ü–æ—Å—Ç', wall_reply: '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π', market: '–¢–æ–≤–∞—Ä', gift: '–ü–æ–¥–∞—Ä–æ–∫', story: '–ò—Å—Ç–æ—Ä–∏—è', graffiti: '–ì—Ä–∞—Ñ—Ñ–∏—Ç–∏', podcast: '–ü–æ–¥–∫–∞—Å—Ç', share: '–†–µ–ø–æ—Å—Ç', file: '–§–∞–π–ª' }; // –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –ø–æ–¥–ø–∏—Å–∏ —Ç–∏–ø–æ–≤
    const attachmentTypeClasses = { photo: 'attachment-photo', video: 'attachment-video', doc: 'attachment-doc', audio: 'attachment-audio', audio_message: 'attachment-audio', link: 'attachment-link', wall: 'attachment-wall', wall_reply: 'attachment-wall', sticker: 'attachment-sticker', default: 'attachment-generic' }; // –ö–ª–∞—Å—Å—ã –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Ç–∏–ø–æ–≤

    function normalizeAttachmentLink(att) { // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–ª–æ–∂–µ–Ω–∏–µ
      if (!att || typeof att !== 'object') { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –æ–±—ä–µ–∫—Ç–∞
        return null; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      return att.public_url || att.download_url || att.url || null; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Å—ã–ª–∫—É –∏–ª–∏ null
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function isVideoType(type) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ —Ç–∏–ø –∫ –≤–∏–¥–µ–æ
      return type === 'video' || type === 'story'; // –°—á–∏—Ç–∞–µ–º –≤–∏–¥–µ–æ –∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∏–¥–µ–æ–∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∏–¥–µ–æ

    function collectAttachmentItems(list, origin, bucket) { // –°–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è –≤ –ø–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
      if (!Array.isArray(list)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        return; // –í—ã—Ö–æ–¥–∏–º, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ —Å–ø–∏—Å–æ–∫
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      list.forEach((att) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è
        if (!att || typeof att !== 'object') { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–∞
          return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
        const url = normalizeAttachmentLink(att); // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –≤–ª–æ–∂–µ–Ω–∏–µ
        if (!url) { // –ï—Å–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–µ—Ç
          return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Å—Å—ã–ª–∫–∏
        const type = att.type || 'file'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–ª–æ–∂–µ–Ω–∏—è
        const caption = att.title || att.name || att.doc?.title || att.link?.title || att.photo?.text || att.description || ''; // –ü–æ–¥–±–∏—Ä–∞–µ–º –ø–æ–¥–ø–∏—Å—å
        bucket.push({ url, type, caption, origin: origin || '–°–æ–æ–±—â–µ–Ω–∏–µ' }); // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫
      }); // –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ–±–æ—Ä–∞
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –≤–ª–æ–∂–µ–Ω–∏–π

    function collectCopyHistoryItems(entries, origin, bucket) { // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è –∏–∑ —Ä–µ–ø–æ—Å—Ç–æ–≤
      if (!Array.isArray(entries)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç
        return; // –í—ã—Ö–æ–¥–∏–º –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ç–∏–ø–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      entries.forEach((entry) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —Ä–µ–ø–æ—Å—Ç—ã
        if (!entry || typeof entry !== 'object') { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –∑–∞–ø–∏—Å–∏
          return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–≤–µ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞
        const entryOrigin = entry.from_name ? `–†–µ–ø–æ—Å—Ç –æ—Ç ${entry.from_name}` : origin || '–†–µ–ø–æ—Å—Ç'; // –§–æ—Ä–º–∏—Ä—É–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
        collectAttachmentItems(entry.attachments || [], entryOrigin, bucket); // –°–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è —Ä–µ–ø–æ—Å—Ç–∞
        if (Array.isArray(entry.copy_history) && entry.copy_history.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ—Å—Ç–æ–≤
          collectCopyHistoryItems(entry.copy_history, entryOrigin, bucket); // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ—Å—Ç–æ–≤
      }); // –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ–±–æ—Ä–∞ —Ä–µ–ø–æ—Å—Ç–æ–≤
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Å–±–æ—Ä–∞ –≤–ª–æ–∂–µ–Ω–∏–π –∏–∑ copy_history

    function registerGallery(message, galleryKey) { // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≥–∞–ª–µ—Ä–µ—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      if (!galleryKey) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
        return; // –í—ã—Ö–æ–¥–∏–º, –µ—Å–ª–∏ –∫–ª—é—á –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–∞
      const bucket = []; // –ì–æ—Ç–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ –≤–ª–æ–∂–µ–Ω–∏–π
      const authorLabel = message.from_name ? `${message.from_name} (ID: ${message.from_id ?? '‚Äî'})` : `ID: ${message.from_id ?? '‚Äî'}`; // –ü–æ–¥–ø–∏—Å—å –∞–≤—Ç–æ—Ä–∞
      const peerLabel = message.peer_title ? `${message.peer_title} (ID: ${message.peer_id ?? '‚Äî'})` : `ID: ${message.peer_id ?? '‚Äî'}`; // –ü–æ–¥–ø–∏—Å—å —á–∞—Ç–∞
      const meta = { author: authorLabel, peer: peerLabel, text: message.text || '–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞' }; // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–∞–ª–∫–∏
      collectAttachmentItems(message.attachments || [], '–°–æ–æ–±—â–µ–Ω–∏–µ', bucket); // –°–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      collectCopyHistoryItems(message.copy_history || [], '–†–µ–ø–æ—Å—Ç', bucket); // –°–æ–±–∏—Ä–∞–µ–º –≤–ª–æ–∂–µ–Ω–∏—è —Ä–µ–ø–æ—Å—Ç–æ–≤
      if (!bucket.length) { // –ï—Å–ª–∏ –Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–∏–π
        return; // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Å—Ç—É—é –≥–∞–ª–µ—Ä–µ—é
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—É—Å—Ç–æ—Ç—ã
      galleryStore[galleryKey] = { items: bucket, meta }; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥–∞–ª–µ—Ä–µ—é –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≥–∞–ª–µ—Ä–µ–∏

    function pickAttachmentClass(type) { // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ CSS-–∫–ª–∞—Å—Å–∞
      if (!type) { // –ï—Å–ª–∏ —Ç–∏–ø –Ω–µ —É–∫–∞–∑–∞–Ω
        return attachmentTypeClasses.default; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–ª–∞—Å—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      return attachmentTypeClasses[type] || attachmentTypeClasses.default; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–ª–∞—Å—Å –∏–ª–∏ –∑–∞–ø–∞—Å–Ω–æ–π
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function buildAttachmentBadge(att, galleryKey, originLabel) { // –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∫–∏ –±–µ–π–¥–∂–∞ –≤–ª–æ–∂–µ–Ω–∏—è
      const type = att?.type || 'file'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–ª–æ–∂–µ–Ω–∏—è
      const readableType = attachmentTypeLabels[type] || type; // –ù–∞—Ö–æ–¥–∏–º –ø–æ–¥–ø–∏—Å—å —Ç–∏–ø–∞
      const href = normalizeAttachmentLink(att); // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞
      const caption = att?.title || att?.name || att?.doc?.title || att?.link?.title || att?.photo?.text || att?.description || ''; // –ü–æ–¥–±–∏—Ä–∞–µ–º –ø–æ–¥–ø–∏—Å—å
      const shortCaption = caption ? caption.slice(0, 60) : ''; // –û–±—Ä–µ–∑–∞–µ–º –ø–æ–¥–ø–∏—Å—å
      const className = pickAttachmentClass(type); // –ë–µ—Ä–µ–º –∫–ª–∞—Å—Å –ø–æ–¥—Å–≤–µ—Ç–∫–∏
      const text = shortCaption ? `${readableType}: ${shortCaption}` : readableType; // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
      const originAttr = originLabel ? ` data-gallery-origin="${originLabel}"` : ''; // –ê—Ç—Ä–∏–±—É—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –∫–ª–∏–∫–∞
      if (href) { // –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞
        return `<a class="attachment-pill ${className}" href="${href}" data-gallery-key="${galleryKey}"${originAttr} data-gallery-url="${href}" target="_blank" rel="noopener noreferrer">${text}</a>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –±–µ–π–¥–∂
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      return `<span class="attachment-pill ${className}" data-gallery-key="${galleryKey}"${originAttr}>${text}</span>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞—Ç–∏—á–Ω—ã–π –±–µ–π–¥–∂
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function renderAttachmentList(list, galleryKey, originLabel) { // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ —Å–ø–∏—Å–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π
      if (!Array.isArray(list) || !list.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        return '<span class="text-secondary small">–ù–µ—Ç –≤–ª–æ–∂–µ–Ω–∏–π</span>'; // –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø—Ä–∏ –ø—É—Å—Ç–æ–º —Å–ø–∏—Å–∫–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const badges = list.map((att) => buildAttachmentBadge(att, galleryKey, originLabel)).join(''); // –°–æ–±–∏—Ä–∞–µ–º –±–µ–π–¥–∂–∏
      return `<div class="attachment-group">${badges}</div>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function renderCopyHistory(copyHistory, galleryKey) { // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ —Ä–µ–ø–æ—Å—Ç–æ–≤
      if (!Array.isArray(copyHistory) || !copyHistory.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–µ–ø–æ—Å—Ç–æ–≤
        return ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const blocks = copyHistory.map((entry) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —Ä–µ–ø–æ—Å—Ç—ã
        const source = entry.from_name ? `${entry.from_name} (ID: ${entry.from_id ?? '‚Äî'})` : `ID: ${entry.from_id ?? '‚Äî'}`; // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–¥–ø–∏—Å—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞
        const text = entry.text ? entry.text.slice(0, 120) : '–ë–µ–∑ —Ç–µ–∫—Å—Ç–∞'; // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞
        const attachmentsBlock = renderAttachmentList(entry.attachments || [], galleryKey, source); // –§–æ—Ä–º–∏—Ä—É–µ–º –≤–ª–æ–∂–µ–Ω–∏—è —Ä–µ–ø–æ—Å—Ç–∞
        return `<div class="copy-block"><div class="copy-header">üîÅ –†–µ–ø–æ—Å—Ç –æ—Ç ${source}</div><div class="text-secondary small">${text}</div><div class="copy-attachments">${attachmentsBlock}</div></div>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É —Ä–µ–ø–æ—Å—Ç–∞
      }); // –ö–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞
      return blocks.join(''); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π HTML
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function buildContentCell(attachments, copyHistory, galleryKey) { // –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∫–∏ —è—á–µ–π–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
      const hasAttachments = Array.isArray(attachments) && attachments.length > 0; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π
      const hasCopy = Array.isArray(copyHistory) && copyHistory.length > 0; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–µ–ø–æ—Å—Ç–æ–≤
      if (!hasAttachments && !hasCopy) { // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
        return '<span class="text-secondary">‚Äî</span>'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const attachmentsBlock = hasAttachments ? renderAttachmentList(attachments, galleryKey, '–°–æ–æ–±—â–µ–Ω–∏–µ') : ''; // –°–æ–±–∏—Ä–∞–µ–º –±–ª–æ–∫ –≤–ª–æ–∂–µ–Ω–∏–π
      const copyBlock = hasCopy ? renderCopyHistory(copyHistory, galleryKey) : ''; // –°–æ–±–∏—Ä–∞–µ–º –±–ª–æ–∫ —Ä–µ–ø–æ—Å—Ç–æ–≤
      return `<div class="content-cell">${attachmentsBlock}${copyBlock}</div>`; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é —è—á–µ–π–∫—É
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏

    function renderGallerySlide(galleryData, index) { // –†–∏—Å—É–µ–º —Ç–µ–∫—É—â–∏–π —Å–ª–∞–π–¥ –≥–∞–ª–µ—Ä–µ–∏
      if (!galleryData || !Array.isArray(galleryData.items) || !galleryData.items.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        galleryMedia.innerHTML = '<div class="text-secondary">–í–ª–æ–∂–µ–Ω–∏–π –Ω–µ—Ç</div>'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
        galleryCaption.textContent = '‚Äî'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å
        galleryOrigin.textContent = '–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
        galleryLinks.innerHTML = '‚Äî'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Å—ã–ª–∫–∏
        return; // –í—ã—Ö–æ–¥–∏–º
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const boundedIndex = Math.max(0, Math.min(index, galleryData.items.length - 1)); // –§–∏–∫—Å–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö
      currentGalleryIndex = boundedIndex; // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å
      const item = galleryData.items[boundedIndex]; // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
      const isVideo = isVideoType(item.type); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç–ª–µ–º–µ–Ω—Ç –≤–∏–¥–µ–æ
      const mediaHtml = isVideo ? `<video controls src="${item.url}" class="w-100" preload="metadata"></video>` : `<img src="${item.url}" alt="–í–ª–æ–∂–µ–Ω–∏–µ" loading="lazy" />`; // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –º–µ–¥–∏–∞
      galleryMedia.innerHTML = mediaHtml; // –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –º–µ–¥–∏–∞ –≤ –º–æ–¥–∞–ª–∫—É
      const caption = item.caption || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'; // –ü–æ–¥–ø–∏—Å—å —ç–ª–µ–º–µ–Ω—Ç–∞
      const origin = item.origin || galleryData.meta.peer || '–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'; // –ò—Å—Ç–æ—á–Ω–∏–∫ —ç–ª–µ–º–µ–Ω—Ç–∞
      galleryCaption.textContent = caption; // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å
      galleryOrigin.textContent = `${origin} ‚Ä¢ ${galleryData.meta.peer}`; // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
      const openLink = `<a href="${item.url}" target="_blank" rel="noopener noreferrer">–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª</a>`; // –°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª
      galleryLinks.innerHTML = `${openLink} ¬∑ ${galleryData.meta.author}`; // –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –∏ –∞–≤—Ç–æ—Ä–∞
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∞ –≥–∞–ª–µ—Ä–µ–∏

    function openGallery(key, targetUrl, targetOrigin) { // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É –≥–∞–ª–µ—Ä–µ–∏
      const galleryData = galleryStore[key]; // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≥–∞–ª–µ—Ä–µ–∏
      if (!galleryData || !galleryData.items.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        return; // –í—ã—Ö–æ–¥–∏–º –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤–ª–æ–∂–µ–Ω–∏–π
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      currentGalleryKey = key; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª—é—á
      let startIndex = 0; // –°—Ç–∞—Ä—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
      if (targetUrl) { // –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ –≤–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
        const foundIndex = galleryData.items.findIndex((item) => item.url === targetUrl && (!targetOrigin || item.origin === targetOrigin)); // –ò—â–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        if (foundIndex >= 0) { // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
          startIndex = foundIndex; // –ù–∞—á–∏–Ω–∞–µ–º —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
      renderGallerySlide(galleryData, startIndex); // –†–∏—Å—É–µ–º –Ω—É–∂–Ω—ã–π —Å–ª–∞–π–¥
      galleryModal.style.display = 'flex'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–∫–∏

    function closeGallery() { // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É –≥–∞–ª–µ—Ä–µ–∏
      galleryModal.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ–Ω
      currentGalleryKey = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–ª—é—á
      currentGalleryIndex = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–∫—Ä—ã—Ç–∏—è

    function stepGallery(delta) { // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≥–∞–ª–µ—Ä–µ–∏
      if (!currentGalleryKey) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç–∞ –ª–∏ –≥–∞–ª–µ—Ä–µ—è
        return; // –í—ã—Ö–æ–¥–∏–º, –µ—Å–ª–∏ –º–æ–¥–∞–ª–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const galleryData = galleryStore[currentGalleryKey]; // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ–π –≥–∞–ª–µ—Ä–µ–∏
      if (!galleryData || !galleryData.items.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        return; // –í—ã—Ö–æ–¥–∏–º –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤–ª–æ–∂–µ–Ω–∏–π
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      const total = galleryData.items.length; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
      const nextIndex = (currentGalleryIndex + delta + total) % total; // –í—ã—á–∏—Å–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∏–Ω–¥–µ–∫—Å –ø–æ –∫—Ä—É–≥—É
      renderGallerySlide(galleryData, nextIndex); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

    galleryClose.addEventListener('click', () => closeGallery()); // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
    galleryPrev.addEventListener('click', () => stepGallery(-1)); // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
    galleryNext.addEventListener('click', () => stepGallery(1)); // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤–ø–µ—Ä–µ–¥
    galleryModal.addEventListener('click', (evt) => { // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
      if (evt.target === galleryModal) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–µ–ª—å –∫–ª–∏–∫–∞
        closeGallery(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Ñ–æ–Ω—É
    document.addEventListener('keydown', (evt) => { // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
      if (galleryModal.style.display === 'flex') { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç–∞ –ª–∏ –º–æ–¥–∞–ª–∫–∞
        if (evt.key === 'Escape') { // –ö–ª–∞–≤–∏—à–∞ Esc
          closeGallery(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º
        } else if (evt.key === 'ArrowLeft') { // –°—Ç—Ä–µ–ª–∫–∞ –≤–ª–µ–≤–æ
          stepGallery(-1); // –ù–∞–∑–∞–¥
        } else if (evt.key === 'ArrowRight') { // –°—Ç—Ä–µ–ª–∫–∞ –≤–ø—Ä–∞–≤–æ
          stepGallery(1); // –í–ø–µ—Ä–µ–¥
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∞–≤–∏—à
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

    document.addEventListener('click', (evt) => { // –î–µ–ª–µ–≥–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –ø–æ –±–µ–π–¥–∂–∞–º –≤–ª–æ–∂–µ–Ω–∏–π
      const trigger = evt.target.closest('[data-gallery-key]'); // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º
      if (!trigger) { // –ï—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ –ø–æ –±–µ–π–¥–∂—É
        return; // –í—ã—Ö–æ–¥–∏–º
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      evt.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ
      const key = trigger.getAttribute('data-gallery-key'); // –ß–∏—Ç–∞–µ–º –∫–ª—é—á –≥–∞–ª–µ—Ä–µ–∏
      const url = trigger.getAttribute('data-gallery-url'); // –ß–∏—Ç–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª
      const originLabel = trigger.getAttribute('data-gallery-origin'); // –ß–∏—Ç–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
      openGallery(key, url, originLabel); // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
    }); // –ö–æ–Ω–µ—Ü –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

    function switchToMessages() { // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      messagesSection.classList.remove('d-none'); // –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      messagesSection.classList.add('d-block'); // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∫–∞–∑ —Å–µ–∫—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      serviceSection.classList.add('d-none'); // –°–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      serviceSection.classList.remove('d-block'); // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å –ø–æ–∫–∞–∑–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      messagesTabBtn.classList.add('active', 'bg-primary'); // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
      messagesTabBtn.classList.remove('bg-dark', 'border', 'border-secondary'); // –£–±–∏—Ä–∞–µ–º —Å—Ç–∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
      serviceTabBtn.classList.remove('active', 'bg-primary'); // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å —Å–µ—Ä–≤–∏—Å–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
      serviceTabBtn.classList.add('bg-dark', 'border', 'border-secondary'); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

    function switchToService() { // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      serviceSection.classList.remove('d-none'); // –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      serviceSection.classList.add('d-block'); // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∫–∞–∑ —Å–µ–∫—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      messagesSection.classList.add('d-none'); // –°–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π
      messagesSection.classList.remove('d-block'); // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å –ø–æ–∫–∞–∑–∞ —Å–µ–∫—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      serviceTabBtn.classList.add('active', 'bg-primary'); // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      serviceTabBtn.classList.remove('bg-dark', 'border', 'border-secondary'); // –£–±–∏—Ä–∞–µ–º —Å—Ç–∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
      messagesTabBtn.classList.remove('active', 'bg-primary'); // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
      messagesTabBtn.classList.add('bg-dark', 'border', 'border-secondary'); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏

    function renderPeers(peers) { // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
      peerFilter.innerHTML = '<option value="">–í—Å–µ —á–∞—Ç—ã</option>'; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä
      (peers || []).forEach((peer) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —á–∞—Ç—ã
        if (!peer || !Number.isFinite(peer.id)) return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏
        const option = document.createElement('option'); // –°–æ–∑–¥–∞–µ–º –æ–ø—Ü–∏—é
        option.value = peer.id; // –ó–Ω–∞—á–µ–Ω–∏–µ –æ–ø—Ü–∏–∏
        const label = peer.title ? `${peer.title} (ID: ${peer.id})` : peer.id; // –ü–æ–¥–ø–∏—Å—å –æ–ø—Ü–∏–∏
        option.textContent = label; // –¢–µ–∫—Å—Ç –æ–ø—Ü–∏–∏
        peerFilter.appendChild(option); // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é
      }); // –ö–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞
      if (initialPeerId !== null) { // –ï—Å–ª–∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä –∑–∞–¥–∞–Ω
        peerFilter.value = initialPeerId; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
      } // –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —á–∞—Ç–æ–≤

    function renderLogs(logs) { // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ª–æ–≥–æ–≤
      logsBody.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Ç–µ–ª–æ
      Object.keys(galleryStore).forEach((key) => delete galleryStore[key]); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≥–∞–ª–µ—Ä–µ–π
      galleryCounter = 0; // –û–±–Ω—É–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª—é—á–µ–π
      if (!logs.length) { // –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π
        logsBody.innerHTML = '<tr><td colspan="10" class="text-secondary">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>'; // –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
        return; // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—É—Å—Ç–æ—Ç—ã
      logs.forEach((log) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ª–æ–≥–∏
        const row = document.createElement('tr'); // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É
        const galleryKey = `log-${log.id ?? 'local'}-${galleryCounter++}`; // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–ª—é—á –≥–∞–ª–µ—Ä–µ–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
        registerGallery(log, galleryKey); // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –º–æ–¥–∞–ª–∫–∏
        const contentCell = buildContentCell(log.attachments, log.copy_history, galleryKey); // –§–æ—Ä–º–∏—Ä—É–µ–º —è—á–µ–π–∫—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        const botBadge = log.is_bot ? '–î–∞' : '–ù–µ—Ç'; // –§–ª–∞–≥ –±–æ—Ç–∞
        const peerLabel = log.peer_title ? `${log.peer_title} (ID: ${log.peer_id ?? '‚Äî'})` : `${log.peer_id ?? '‚Äî'}`; // –ü–æ–¥–ø–∏—Å—å —á–∞—Ç–∞
        const authorLabel = log.from_name ? `${log.from_name} (ID: ${log.from_id ?? '‚Äî'})` : `${log.from_id ?? '‚Äî'}`; // –ü–æ–¥–ø–∏—Å—å –∞–≤—Ç–æ—Ä–∞
        const createdAt = formatDateTime(log.created_at); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤—Ä–µ–º—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
        const replyCell = buildReplyPreview(log.reply, log.peer_id); // –ì–æ—Ç–æ–≤–∏–º —è—á–µ–π–∫—É –ø—Ä–µ–≤—å—é –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        row.innerHTML = `<td>${createdAt}</td><td>${peerLabel}</td><td>${authorLabel}</td><td>${botBadge}</td><td>${replyCell}</td><td>${contentCell}</td><td>${log.text ?? ''}</td><td>${log.message_id ?? '‚Äî'}</td><td>${log.id ?? '‚Äî'}</td><td><button type="button" class="btn btn-sm btn-outline-danger delete-log-btn" data-log-id="${log.id}">–£–¥–∞–ª–∏—Ç—å</button></td>`; // –ó–∞–ø–æ–ª–Ω—è–µ–º —è—á–µ–π–∫–∏ –∏ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è
        logsBody.appendChild(row); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É
      }); // –ö–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏

    async function deleteLog(recordId) { // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏
      const confirmed = window.confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É –ª–æ–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π? –î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.'); // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
      if (!confirmed) { // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª—Å—è
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≥–ª–∞—Å–∏—è
      try { // –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
        const response = await fetch(`/api/logs/${recordId}`, { method: 'DELETE' }); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —É–¥–∞–ª–µ–Ω–∏—è
        if (!response.ok) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
          throw new Error('–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π'); // –ë—Ä–æ—Å–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–µ
        } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞
        await refreshLogs(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
      } catch (err) { // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –ª–æ–≥–∞', err); // –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–±–ª–µ–º—É
      } // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

    function renderServiceLogs(logs) { // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
      serviceBody.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Ç–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
      if (!logs.length) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
        serviceBody.innerHTML = '<tr><td colspan="5" class="text-secondary">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>'; // –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
        return; // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏
      logs.forEach((log) => { // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
        const row = document.createElement('tr'); // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É
        const type = log.event_type || 'info'; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è
        const badgeClass = `service-pill ${type}`; // –ì–æ—Ç–æ–≤–∏–º –∫–ª–∞—Å—Å –ø–∏–ª—é–ª–∏
        const dotClass = `service-dot ${type}`; // –ì–æ—Ç–æ–≤–∏–º –∫–ª–∞—Å—Å —Ç–æ—á–∫–∏
        const createdAt = formatDateTime(log.created_at); // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
        row.innerHTML = `<td>${createdAt}</td><td><span class="${badgeClass}"><span class="${dotClass}"></span>${type}</span></td><td>${log.status_code ?? '‚Äî'}</td><td>${log.description ?? '‚Äî'}</td><td>${log.message ?? ''}</td>`; // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç—Ä–æ–∫—É
        serviceBody.appendChild(row); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É
      }); // –ö–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤

    async function fetchLogs(params) { // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –ª–æ–≥–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
      const searchParams = new URLSearchParams(params); // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      const response = await fetch(`/api/logs?${searchParams.toString()}`); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
      const data = await response.json(); // –ß–∏—Ç–∞–µ–º JSON
      return data.items || []; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ª–æ–≥–æ–≤
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞

    async function fetchServiceLogs(params) { // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
      const searchParams = new URLSearchParams(params); // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
      const response = await fetch(`/api/service-logs?${searchParams.toString()}`); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
      const data = await response.json(); // –ß–∏—Ç–∞–µ–º JSON
      return data; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤

    async function refreshLogs() { // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
      try { // –ë–ª–æ–∫ –ø–æ–ø—ã—Ç–∫–∏
        const params = {}; // –û–±—ä–µ–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
        if (peerFilter.value) { // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —á–∞—Ç
          params.peer_id = peerFilter.value; // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä —á–∞—Ç–∞
        } // –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è
        if (limitInput.value) { // –ï—Å–ª–∏ –∑–∞–¥–∞–Ω –ª–∏–º–∏—Ç
          params.limit = limitInput.value; // –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–º–∏—Ç
        } // –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è
        const logs = await fetchLogs(params); // –ü–æ–ª—É—á–∞–µ–º –ª–æ–≥–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
        renderLogs(logs); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
      } catch (err) { // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏', err); // –ü–∏—à–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å
      } // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

    async function clearLogs() { // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
      const confirmed = window.confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –∑–∞–ø–∏—Å–∏ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.'); // –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      if (!confirmed) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–∫–∞–∑
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      try { // –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
        await fetch('/api/logs/clear', { method: 'POST' }); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ –æ—á–∏—Å—Ç–∫—É –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
        await refreshLogs(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
      } catch (err) { // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π', err); // –ü–∏—à–µ–º –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
      } // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

    async function refreshServiceLogs() { // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      try { // –ë–ª–æ–∫ –ø–æ–ø—ã—Ç–∫–∏
        const params = {}; // –ì–æ—Ç–æ–≤–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        const limit = Number(serviceLimitInput.value) || 50; // –ß–∏—Ç–∞–µ–º –ª–∏–º–∏—Ç
        if (serviceTypeSelect.value) { // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ç–∏–ø
          params.event_type = serviceTypeSelect.value; // –î–æ–±–∞–≤–ª—è–µ–º —Ç–∏–ø
        } // –ö–æ–Ω–µ—Ü —É—Å–ª–æ–≤–∏—è
        params.limit = limit; // –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–º–∏—Ç
        params.offset = serviceOffset; // –î–æ–±–∞–≤–ª—è–µ–º —Å–º–µ—â–µ–Ω–∏–µ
        const result = await fetchServiceLogs(params); // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        serviceTotal = Number(result.total || 0); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        renderServiceLogs(result.items || []); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
        const end = Math.min(serviceOffset + limit, serviceTotal || 0); // –°—á–∏—Ç–∞–µ–º –∫–æ–Ω–µ—Ü –¥–∏–∞–ø–∞–∑–æ–Ω–∞
        servicePrevBtn.disabled = serviceOffset === 0; // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –ø—Ä–∏ –Ω—É–ª–µ
        serviceNextBtn.disabled = serviceOffset + limit >= serviceTotal; // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≤–ø–µ—Ä–µ–¥ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ–Ω—Ü–∞
        servicePageLabel.textContent = serviceTotal ? `–ü–æ–∫–∞–∑–∞–Ω–æ ${end} –∏–∑ ${serviceTotal}` : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'; // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å—å
      } catch (err) { // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏', err); // –ü–∏—à–µ–º –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
      } // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤

    async function clearServiceLogs() { // –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      const confirmed = window.confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.'); // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      if (!confirmed) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–º–µ–Ω—É
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      try { // –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
        await fetch('/api/service-logs/clear', { method: 'POST' }); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST –æ—á–∏—Å—Ç–∫–∏
        serviceOffset = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ
        await refreshServiceLogs(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
      } catch (err) { // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏', err); // –ü–∏—à–µ–º –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
      } // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
    } // –ö–æ–Ω–µ—Ü —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏

    filtersForm.addEventListener('submit', (event) => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
      event.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
      refreshLogs(); // –ü–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ª–æ–≥–∏
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ñ–æ—Ä–º—ã

    logsBody.addEventListener('click', (event) => { // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ —Ç–∞–±–ª–∏—Ü–µ –ª–æ–≥–æ–≤
      const deleteButton = event.target.closest('.delete-log-btn'); // –ò—â–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è
      if (!deleteButton) { // –ï—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ –ø–æ –∫–Ω–æ–ø–∫–µ —É–¥–∞–ª–µ–Ω–∏—è
        return; // –ü—Ä–µ—Ä—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–ª–∏–∫–∞
      const recordId = deleteButton.dataset.logId; // –ë–µ—Ä–µ–º ID –∑–∞–ø–∏—Å–∏ –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–∞
      if (!recordId) { // –ï—Å–ª–∏ ID –Ω–µ –Ω–∞–π–¥–µ–Ω
        return; // –ó–∞–≤–µ—Ä—à–∞–µ–º –±–µ–∑ –≤—ã–∑–æ–≤–∞ API
      } // –ö–æ–Ω–µ—Ü –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è ID
      deleteLog(recordId); // –ó–∞–ø—É—Å–∫–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    }); // –ö–æ–Ω–µ—Ü –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

    refreshBtn.addEventListener('click', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      refreshLogs(); // –ü–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ª–æ–≥–∏
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏

    clearBtn.addEventListener('click', (event) => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
      event.preventDefault(); // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–∫–∏
      clearLogs(); // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—á–∏—Å—Ç–∫—É –ª–æ–≥–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏

    serviceRefreshBtn.addEventListener('click', (event) => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      event.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–∫–∏
      refreshServiceLogs(); // –ü–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

    serviceClearBtn.addEventListener('click', (event) => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏
      event.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–∫–∏
      clearServiceLogs(); // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—á–∏—Å—Ç–∫—É
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏

    serviceTypeSelect.addEventListener('change', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã —Ç–∏–ø–∞
      serviceOffset = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ
      refreshServiceLogs(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–º–µ–Ω—ã —Ç–∏–ø–∞

    serviceLimitInput.addEventListener('change', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã –ª–∏–º–∏—Ç–∞
      serviceOffset = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ
      refreshServiceLogs(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–º–µ–Ω—ã –ª–∏–º–∏—Ç–∞

    servicePrevBtn.addEventListener('click', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
      const limit = Number(serviceLimitInput.value) || 50; // –ß–∏—Ç–∞–µ–º –ª–∏–º–∏—Ç
      serviceOffset = Math.max(0, serviceOffset - limit); // –£–º–µ–Ω—å—à–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ
      refreshServiceLogs(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥

    serviceNextBtn.addEventListener('click', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤–ø–µ—Ä–µ–¥
      const limit = Number(serviceLimitInput.value) || 50; // –ß–∏—Ç–∞–µ–º –ª–∏–º–∏—Ç
      serviceOffset += limit; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ
      refreshServiceLogs(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –≤–ø–µ—Ä–µ–¥

    messagesTabBtn.addEventListener('click', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
      switchToMessages(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

    serviceTabBtn.addEventListener('click', () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      switchToService(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
      refreshServiceLogs(); // –ü–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ
    }); // –ö–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤–∫–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤

    limitInput.value = initialLimit; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –ª–∏–º–∏—Ç
    renderPeers(initialPeers || []); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä —á–∞—Ç–æ–≤
    renderLogs(initialLogs || []); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ª–æ–≥–∏
    serviceTotal = (initialServiceLogs || []).length; // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ª–æ–≥–æ–≤
    servicePageLabel.textContent = serviceTotal ? `–ü–æ–∫–∞–∑–∞–Ω–æ ${Math.min(serviceTotal, Number(serviceLimitInput.value) || 50)} –∏–∑ ${serviceTotal}` : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    renderServiceLogs(initialServiceLogs || []); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ª–æ–≥–∏
    switchToMessages(); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –∞–∫—Ç–∏–≤–Ω–æ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  </script> <!-- –ö–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞ -->
</body> <!-- –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ -->
</html> <!-- –ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞ -->
