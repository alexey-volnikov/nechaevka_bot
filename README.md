# nechaevka_bot

Минимальный мониторинговый бот для сообщества ВКонтакте. Скрипт подключается к Long Poll API, считывает события и показывает их в простом локальном дашборде без отправки сообщений от имени сообщества. Подходит, чтобы безопасно понять, какие данные доступны боту в чате и в сообществе.

## Что умеет
- Подключается к Long Poll от имени сообщества и фиксирует входящие события.
- Не отправляет никаких сообщений, только читает и пишет события в лог.
- Сохраняет последние полученные сообщения (ID отправителя, peer_id, текст) для просмотра.
- Показывает базовую информацию о сообществе (`description`, `members_count`, контакты).
- Снимает список доступных диалогов и чатов без взаимодействия с ними.
- Выдает статистику через локальный Flask-дейшборд (`/` и `/stats`).

## Подготовка окружения
1. Установите Python 3.10+ и pip (в Windows можно через Microsoft Store или официальный установщик).
2. Склонируйте репозиторий или скачайте архив в папку, где работает VS Code.
3. Создайте виртуальное окружение (рекомендуется):
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\\Scripts\\activate
   ```
4. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
5. Скопируйте файл `.env.example` в `.env` и впишите данные своего сообщества:
   ```
   VK_GROUP_TOKEN=ваш_токен_сообщества
   VK_GROUP_ID=числовой_id_сообщества
   PORT=8000  # Можно изменить при необходимости
   ```
   > Токен должен иметь права на сообщения сообщества. В коде нет вызовов `messages.send`, поэтому бот не будет писать в чаты.

## Запуск
1. Активируйте виртуальное окружение (если неактивно) и выполните:
   ```bash
   python app.py
   ```
2. В логах появится сообщение о запуске дашборда. Откройте браузер на `http://127.0.0.1:8000`.
   - `/` — обзор: краткое описание, сведения о сообществе и список последних диалогов.
   - `/stats` — счетчики событий, последние сообщения (ID отправителя, peer_id, текст) и ошибки, если были.
3. Оставьте терминал открытым: лонгпулл работает в фоновом потоке и слушает новые события.

## Что можно посмотреть
- В логах увидите входящие сообщения с указанием peer_id и текста.
- На `/stats` — количество событий, сообщений, приглашений/удалений из чатов и последние тексты.
- На `/` — описание сообщества, число участников, контакты (если заданы), список доступных диалогов.

## Потенциал
- Добавить фильтры или сохранение событий в базу данных для дальнейшей аналитики.
- Визуализировать статистику (графики) через любой frontend или n8n, читая JSON с `/stats`.
- Подключить webhooks для уведомлений без отправки сообщений от имени бота.

## Замечания по безопасности
- Не храните боевой токен в репозитории: используйте `.env` (в репо лежит только `.env.example`).
- Скрипт принципиально не вызывает методы отправки сообщений, чтобы не нарушать правило «бот не пишет в чаты».
- Для Docker можно собрать простой образ, но на Windows удобнее запустить через VS Code и локальный Python.
